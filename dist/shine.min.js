/*! shine.js - v0.1.0 - 2014-04-02
* http://bigspaceship.github.io/shine.js
* Copyright (c) 2014 Big Spaceship; Licensed MIT */

!function(a,b){"use strict";b.shinejs=a,a.Color=function(a,b,c){this.r=a||0,this.g=b||0,this.b=c||0},a.Light=function(){this.position=new a.Point(0,0),this.intensity=1},a.Point=function(a,b){this.x=a||0,this.y=b||0},a.Point.prototype.delta=function(b){return new a.Point(b.x-this.x,b.y-this.y)},a.Shadow=function(b){this.stepSize=8,this.maxSteps=5,this.opacityMultiplier=.15,this.opacityPow=1.2,this.offsetMultiplier=.15,this.offsetPow=1.8,this.blurMultiplier=.1,this.blurPow=1.4,this.maxBlurRadius=64,this.position=new a.Point(0,0),this.domElement=b,this.shadowProperty="textShadow",this.shadowRGB=new a.Color(0,0,0),this.fnHandleViewportUpdate=this.handleViewportUpdate.bind(this),this.enableAutoUpdates(),this.handleViewportUpdate()},a.Shadow.prototype.draw=function(a){var b=this.position.delta(a.position),c=Math.sqrt(b.x*b.x+b.y*b.y);c=Math.max(40,c);var d=c/this.stepSize;d=Math.min(this.maxSteps,Math.round(d));for(var e=[],f=0;d>f;f++){var g=f/d,h=Math.pow(g,this.opacityPow),i=Math.pow(g,this.offsetPow),j=Math.pow(g,this.blurPow),k=a.intensity*Math.max(0,this.opacityMultiplier*(1-h)),l=-this.offsetMultiplier*b.x*i,m=-this.offsetMultiplier*b.y*i,n=this.blurMultiplier*c*j;n=Math.min(this.maxBlurRadius,n);var o=this.getShadow(this.shadowRGB,k,l,m,n);e.push(o)}this.drawShadows(e)},a.Shadow.prototype.getShadow=function(a,b,c,d,e){var f="rgba("+a.r+", "+a.g+", "+a.b+", "+b+")";return f+" "+c+"px "+d+"px "+e+"px"},a.Shadow.prototype.drawShadows=function(a){this.domElement.style[this.shadowProperty]=a.join(", ")},a.Shadow.prototype.enableAutoUpdates=function(){this.disableAutoUpdates(),document.addEventListener("resize",this.fnHandleViewportUpdate,!1),document.addEventListener("load",this.fnHandleViewportUpdate,!1),window.addEventListener("resize",this.fnHandleViewportUpdate,!1),window.addEventListener("scroll",this.fnHandleViewportUpdate,!1)},a.Shadow.prototype.disableAutoUpdates=function(){document.removeEventListener("resize",this.fnHandleViewportUpdate,!1),document.removeEventListener("load",this.fnHandleViewportUpdate,!1),window.removeEventListener("resize",this.fnHandleViewportUpdate,!1),window.removeEventListener("scroll",this.fnHandleViewportUpdate,!1)},a.Shadow.prototype.handleViewportUpdate=function(){var a=this.domElement.getBoundingClientRect();this.position.x=a.left+.5*a.width,this.position.y=a.top+.5*a.height},a.Splitter=function(a,b){this.domElement=a,this.classPrefix=b||"",this.wrapperElement=document.createElement("div"),this.maskElement=document.createElement("div"),this.wordElements=[],this.letterElements=[],this.split()},a.Splitter.prototype.split=function(){this.wrapperElement.className=this.classPrefix+"wrapper";for(var a=this.domElement.textContent,b=a.length,c=null,d=0;b>d;d++){var e=a.charAt(d);if(c||(c=document.createElement("span"),c.className=this.classPrefix+"word",this.wrapperElement.appendChild(c),this.wordElements.push(c)),e.match(/[\s]/)){var f=document.createElement("span");f.className=this.classPrefix+"spacer",f.innerHTML=e,this.wrapperElement.appendChild(f),c=null}else{var g=document.createElement("span");g.innerHTML=e,g.className=this.classPrefix+"letter",this.letterElements.push(g),c.appendChild(g),e.match(/[\W]/)&&(c=null)}}this.maskElement.innerHTML=this.wrapperElement.innerHTML,this.maskElement.className=this.classPrefix+"mask",this.wrapperElement.appendChild(this.maskElement),this.domElement.innerHTML="",this.domElement.appendChild(this.wrapperElement)},a.Splitter.prototype.isSeparatorCharacter=function(a){return a=a||"",a.match(/[\s-,.]/)},a.StyleInjector=function(){this.injections={}},a.StyleInjector.instance_=null,a.StyleInjector.getInstance=function(){return a.StyleInjector.instance_||(a.StyleInjector.instance_=new a.StyleInjector),a.StyleInjector.instance_},a.StyleInjector.prototype.inject=function(a,b){if(b=b||window.document,this.injections[a]!==b){var c=document.createElement("style");c.type="text/css",c.innerHTML=a;var d=b.getElementsByTagName("head")[0].firstChild;return b.getElementsByTagName("head")[0].insertBefore(c,d),this.injections[a]=b,c}},a.Shine=function(b,c,d){var e=this;if(c=c||"shine-",d=d||"textShadow",!b)throw new Error("No valid DOM element passed as first parameter");if(b.children&&b.children.length>0)throw new Error("Shine only works on elements with text content. The DOM element cannot have any children.");this.domElement=b,this.light=new a.Light,this.shadows=[],this.fnDrawHandler=function(){e.draw()},this.init(c,d)},a.Shine.prototype.enableAutoUpdates=function(){this.disableAutoUpdates(),window.addEventListener("scroll",this.fnDrawHandler,!1),window.addEventListener("resize",this.fnDrawHandler,!1);for(var a=this.shadows.length-1;a>=0;a--){var b=this.shadows[a];b.enableAutoUpdates()}},a.Shine.prototype.disableAutoUpdates=function(){window.removeEventListener("scroll",this.fnDrawHandler,!1),window.removeEventListener("resize",this.fnDrawHandler,!1);for(var a=this.shadows.length-1;a>=0;a--){var b=this.shadows[a];b.disableAutoUpdates()}},a.Shine.prototype.draw=function(){for(var a=0;a<this.shadows.length;a++){var b=this.shadows[a];b.draw(this.light)}},a.Shine.prototype.init=function(b,c){a.StyleInjector.getInstance().inject(this.getCSS());for(var d=new a.Splitter(this.domElement,b),e=0;e<d.letterElements.length;e++){var f=d.letterElements[e],g=new a.Shadow(f);g.shadowProperty=c,this.shadows.push(g)}this.enableAutoUpdates()},a.Shine.prototype.getCSS=function(){return"/* shine.js styles */.shine-wrapper { display: inline-block; position: relative; max-width: 100%;}.shine-word { display: inline-block; white-space: nowrap;}.shine-letter { position: relative; display: inline-block;}.shine-mask { position: absolute; top: 0; left: 0; right: 0; bottom: 0;}"},b.Shine=b.Shine||a.Shine}({},function(){return this}());
//# sourceMappingURL=shine.min.map